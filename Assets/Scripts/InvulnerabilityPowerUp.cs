using System.Collections;
using UnityEngine;
using UnityEngine.Events;

public class InvulnerabilityPowerUp : MonoBehaviour, ITrigger
{
    [SerializeField] PlayerCollider playerCollider;
    [SerializeField] PlayerMaterial playerMaterial;

    [SerializeField] float powerUpDuration = 2.0f;

    [SerializeField] UnityEvent onTriggered;


    public void Trigger() {
        onTriggered?.Invoke();
        StartCoroutine(GainInvulnerability());
        transform.position = Vector3.down * 5.0f;
    }

    IEnumerator GainInvulnerability() {
        playerCollider.SetInvulnerability(true);
        playerMaterial.SetMaterialsColor(Color.green);

        yield return new WaitForSeconds(powerUpDuration);

        playerMaterial.SetMaterialsColor(Color.white);
        playerCollider.SetInvulnerability(false);

        Destroy(gameObject);
    }
}
